<html lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KeeperRL Mod File Editor</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/themes/prism.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/components/prism-javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <style>
        body {
            margin: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            padding: 20px;
            font-family: Arial, sans-serif;
        }
        h1 {
            text-align: center;
        }
        input[type="text"], textarea {
            width: 100%;
            resize: none;
            font-family: monospace;
            margin-bottom: 20px; /* Space between controls */
        }
        button {
            padding: 10px 20px;
            cursor: pointer;
            display: block;
            margin: 0 auto; /* Center the button */
        }
        /* Tab styles */
        .tab {
            overflow: hidden;
            background-color: #f1f1f1;
            margin-bottom: 10px; /* Space between tabs and textareas */
        }
        .tab button {
            background-color: inherit;
            float: left;
            border: none;
            outline: none;
            cursor: pointer;
            padding: 14px 16px;
            transition: 0.3s;
        }
        .tab button:hover {
            background-color: #ddd;
        }
        .tab button.active {
            background-color: #ccc;
        }
        .tabcontent {
            display: none;
            padding: 6px 12px;
            border: 1px solid #ccc;
            border-top: none;
            margin-bottom: 20px; /* Space between tabs and download button */
        }
        .tabcontent textarea {
            height: 300px;
        }
        /* Specific height for detailsInput */
        #detailsInput {
            height: 120px; /* Height for at least 6 lines */
        }
        .code-container {
            display: none;
            margin-top: 10px;
        }
        .checkbox-container {
            display: inline-block;
            margin-left: 10px; /* Space between label and checkbox */
        }
    </style>
</head>
<body>

    <h1>KeeperRL Mod File Editor</h1>

    <!-- Mod Name Input -->
    <label for="modName">Enter Mod Name:</label>
    <input type="text" id="modName" value="<Change this name>">

    <!-- Tab navigation -->
    <div class="tab" id="tabContainer"><button class="tablinks active" id="defaultOpen">details.txt</button><button class="tablinks">keeper_creatures.txt</button><button class="tablinks">creatures.txt</button><button class="tablinks">campaign_villains.txt</button><button class="tablinks">enemies.txt</button></div>

    <!-- Tab content container -->
    <div id="tabContentContainer"><div id="tab0" class="tabcontent" style="display: block;"><label>Enter content of details.txt:</label><span class="checkbox-container"><input type="checkbox" id="viewToggle0"><label for="viewToggle0"> View as code</label></span><textarea id="details_txt" rows="6">"Softmonster"

"1.0 Mod Tutorial 1 - Adding a Red Dragon Adventurer.

The first lesson in the tutorial series.

We add a new option to play a red dragon as an adventurer.

_________

Challenge
_________

Open:

     KeeperRL\\mods\\1.0 Mod Tutorial 1\\NowYouTry.html

....to create your own dragon adventurer. 


"</textarea><div class="code-container" style="display: none;"><pre class="language-javascript" tabindex="0"><code class="language-javascript"><span class="token string">"Softmonster"</span>

"<span class="token number">1.0</span> Mod Tutorial <span class="token number">1</span> <span class="token operator">-</span> Adding a Red Dragon Adventurer<span class="token punctuation">.</span>

The first lesson <span class="token keyword">in</span> the tutorial series<span class="token punctuation">.</span>

We add a <span class="token keyword">new</span> <span class="token class-name">option</span> to play a red dragon <span class="token keyword">as</span> an adventurer<span class="token punctuation">.</span>

_________

Challenge
_________

<span class="token literal-property property">Open</span><span class="token operator">:</span>

     KeeperRL\\mods\\<span class="token number">1.0</span> Mod Tutorial <span class="token number">1</span>\\NowYouTry<span class="token punctuation">.</span>html

<span class="token operator">...</span><span class="token punctuation">.</span>to create your own dragon adventurer<span class="token punctuation">.</span> 


"</code></pre></div></div><div id="tab1" class="tabcontent" style="display: none;"><label>Enter content of keeper_creatures.txt:</label><span class="checkbox-container"><input type="checkbox" id="viewToggle1"><label for="viewToggle1"> View as code</label></span><textarea id="keeper_creatures_txt" rows="15">"9.1 Red Dragon Adventurer"
{

  #Edit these values to write your own mod. If you hit 'download your mod' in the editor, your edited version of this web pages will be added to your own mod!
  # WOW! magic! #

  #You can construct a new keeper just from the pieces of configuration already defined in vanilla.
  
  #Vanilla config files are found here: https://github.com/miki151/keeperrl/tree/master/data_free/game_config
  
  #eg. https://github.com/miki151/keeperrl/tree/master/data_free/game_config/creatures.txt

  baseName = "Adventurer" #The Type of keeper this will appear under in the game
  creatureId = { "RED_DRAGON" } #Found in Vanilla creatures.txt 
  tribeAlignment = EVIL #EVIL or LAWFUL
  description = "Play as a dragon rampaging villagers." #Make your own description 
  villainGroups = { EVIL_KEEPER EVIL_COTTAGES } #Can replace EVIL with LAWFUL for different enemies
  immigrantGroups = {} #Use this if you want to have immigration from immigration.txt
  technology = {} #Use this if you want to have technology from technology.txt
  zLevelGroups = { "basic" } #choose the zlevels from zlevels.txt
  initialTech = { } #Give the keeper any starting tech you want from technology.txt
  buildingGroups = {} #Choose some top level menu groups for building furniture from build_menu.txt
  workshopGroups = {} #Let the keeper craft things by assigning top level workshop item groups from workshops_menu.txt
  minionTraits = {LEADER WORKER} #CIVILIAN and PRISONER are also valid values.
  maxPopulation = 100 #Increase if you want to allow imigration
  startingBase = { 8 8 } "castle_empty" #Choose a random layout from enemies.txt for your keeper's base
  prisoners = false #Or let them capture
  requireQuartersForExp = false #Put to true if you want to force your keeper to build quarters to level up.
}</textarea><div class="code-container" style="display: none;"><pre class="language-javascript" tabindex="0"><code class="language-javascript"><span class="token string">"9.1 Red Dragon Adventurer"</span>
<span class="token punctuation">{</span>

  #Edit these values to write your own mod<span class="token punctuation">.</span> If you hit <span class="token string">'download your mod'</span> <span class="token keyword">in</span> the editor<span class="token punctuation">,</span> your edited version <span class="token keyword">of</span> <span class="token keyword">this</span> web pages will be added to your own mod<span class="token operator">!</span>
  # <span class="token constant">WOW</span><span class="token operator">!</span> magic<span class="token operator">!</span> #

  #You can construct a <span class="token keyword">new</span> <span class="token class-name">keeper</span> just from the pieces <span class="token keyword">of</span> configuration already defined <span class="token keyword">in</span> vanilla<span class="token punctuation">.</span>
  
  #Vanilla config files are found here<span class="token operator">:</span> https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>github<span class="token punctuation">.</span>com<span class="token operator">/</span>miki151<span class="token operator">/</span>keeperrl<span class="token operator">/</span>tree<span class="token operator">/</span>master<span class="token operator">/</span>data_free<span class="token operator">/</span>game_config
  
  #eg<span class="token punctuation">.</span> https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>github<span class="token punctuation">.</span>com<span class="token operator">/</span>miki151<span class="token operator">/</span>keeperrl<span class="token operator">/</span>tree<span class="token operator">/</span>master<span class="token operator">/</span>data_free<span class="token operator">/</span>game_config<span class="token operator">/</span>creatures<span class="token punctuation">.</span>txt

  baseName <span class="token operator">=</span> <span class="token string">"Roaming Dragon"</span> #The Type <span class="token keyword">of</span> keeper <span class="token keyword">this</span> will appear under <span class="token keyword">in</span> the game
  creatureId <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"RED_DRAGON"</span> <span class="token punctuation">}</span> #Found <span class="token keyword">in</span> Vanilla creatures<span class="token punctuation">.</span>txt 
  tribeAlignment <span class="token operator">=</span> <span class="token constant">EVIL</span> #<span class="token constant">EVIL</span> or <span class="token constant">LAWFUL</span>
  description <span class="token operator">=</span> <span class="token string">"Play as a dragon rampaging villagers."</span> #Make your own description 
  villainGroups <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token constant">EVIL_KEEPER</span> <span class="token constant">EVIL_COTTAGES</span> <span class="token punctuation">}</span> #Can replace <span class="token constant">EVIL</span> <span class="token keyword">with</span> <span class="token constant">LAWFUL</span> <span class="token keyword">for</span> different enemies
  immigrantGroups <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> #Use <span class="token keyword">this</span> <span class="token keyword">if</span> you want to have immigration from immigration<span class="token punctuation">.</span>txt
  technology <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> #Use <span class="token keyword">this</span> <span class="token keyword">if</span> you want to have technology from technology<span class="token punctuation">.</span>txt
  zLevelGroups <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"basic"</span> <span class="token punctuation">}</span> #choose the zlevels from zlevels<span class="token punctuation">.</span>txt
  initialTech <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span> #Give the keeper any starting tech you want from technology<span class="token punctuation">.</span>txt
  buildingGroups <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> #Choose some top level menu groups <span class="token keyword">for</span> building furniture from build_menu<span class="token punctuation">.</span>txt
  workshopGroups <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> #Let the keeper craft things by assigning top level workshop item groups from workshops_menu<span class="token punctuation">.</span>txt
  minionTraits <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token constant">LEADER</span> <span class="token constant">WORKER</span><span class="token punctuation">}</span> #<span class="token constant">CIVILIAN</span> and <span class="token constant">PRISONER</span> are also valid values<span class="token punctuation">.</span>
  maxPopulation <span class="token operator">=</span> <span class="token number">1</span> #Increase <span class="token keyword">if</span> you want to allow imigration
  startingBase <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">8</span> <span class="token number">8</span> <span class="token punctuation">}</span> <span class="token string">"castle_empty"</span> #Choose a random layout from enemies<span class="token punctuation">.</span>txt <span class="token keyword">for</span> your keeper's base
  prisoners <span class="token operator">=</span> <span class="token boolean">false</span> #Or <span class="token keyword">let</span> them capture
  requireQuartersForExp <span class="token operator">=</span> <span class="token boolean">false</span> #Put to <span class="token boolean">true</span> <span class="token keyword">if</span> you want to force your keeper to build quarters to level up<span class="token punctuation">.</span>
<span class="token punctuation">}</span>

<span class="token string">"9.2 Green Dragon Adventurer"</span> inherit <span class="token string">"9.1 Red Dragon Adventurer"</span>
<span class="token punctuation">{</span>
  creatureId <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"GREEN_DRAGON"</span> <span class="token punctuation">}</span> #Found <span class="token keyword">in</span> Vanilla creatures<span class="token punctuation">.</span>txt 
<span class="token punctuation">}</span>

<span class="token string">"9.3 Yellow Dragon Adventurer"</span> inherit <span class="token string">"9.1 Red Dragon Adventurer"</span>
<span class="token punctuation">{</span>
  creatureId <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"YELLOW_DRAGON"</span> <span class="token punctuation">}</span> #Found <span class="token keyword">in</span> Vanilla creatures<span class="token punctuation">.</span>txt 
<span class="token punctuation">}</span>

<span class="token string">"9.4 White Dragon Adventurer"</span> inherit <span class="token string">"9.1 Red Dragon Adventurer"</span>
<span class="token punctuation">{</span>
  creatureId <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"WHITE_DRAGON"</span> <span class="token punctuation">}</span> #Found <span class="token keyword">in</span> Vanilla creatures<span class="token punctuation">.</span>txt 
<span class="token punctuation">}</span>

<span class="token string">"9.5 BLACK Dragon Adventurer"</span> inherit <span class="token string">"9.1 Red Dragon Adventurer"</span>
<span class="token punctuation">{</span>
  creatureId <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"BLACK_DRAGON_PLAYER"</span> <span class="token punctuation">}</span> #Found <span class="token keyword">in</span> Vanilla creatures<span class="token punctuation">.</span>txt 
<span class="token punctuation">}</span>

<span class="token string">"9.6 Blue Dragon Adventurer"</span> inherit <span class="token string">"9.1 Red Dragon Adventurer"</span>
<span class="token punctuation">{</span>
  creatureId <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"BLUE_DRAGON"</span> <span class="token punctuation">}</span> #From the modded version <span class="token keyword">of</span> creatures<span class="token punctuation">.</span>txt 
<span class="token punctuation">}</span>

<span class="token string">"9.1.1 Red Dragon Campaign"</span> inherit <span class="token string">"9.1 Red Dragon Adventurer"</span>
<span class="token punctuation">{</span>
  creatureId <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"RED_DRAGON"</span> <span class="token punctuation">}</span> #Found <span class="token keyword">in</span> Vanilla creatures<span class="token punctuation">.</span>txt
  description <span class="token operator">=</span> <span class="token string">"Play the dragon campaign as a red dragon. The dragon campaign features mostly knights and other dragons as enemies."</span>  
  baseName <span class="token operator">=</span> <span class="token string">"Dragon Campaign"</span>
  villainGroups <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token constant">DRAGON_CAMPAIGN</span> <span class="token constant">DRAGON_COTTAGES</span> <span class="token punctuation">}</span> #Can replace <span class="token constant">EVIL</span> <span class="token keyword">with</span> <span class="token constant">LAWFUL</span> <span class="token keyword">for</span> different enemies
<span class="token punctuation">}</span>

<span class="token string">"9.2.1 Green Dragon Campaign"</span> inherit <span class="token string">"9.1 Red Dragon Adventurer"</span>
<span class="token punctuation">{</span>
  creatureId <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"GREEN_DRAGON"</span> <span class="token punctuation">}</span> #Found <span class="token keyword">in</span> Vanilla creatures<span class="token punctuation">.</span>txt 
  description <span class="token operator">=</span> <span class="token string">"Play the dragon campaign as a red dragon. The dragon campaign features mostly knights and other dragons as enemies."</span>  
  baseName <span class="token operator">=</span> <span class="token string">"Dragon Campaign"</span>
  villainGroups <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token constant">DRAGON_CAMPAIGN</span> <span class="token constant">DRAGON_COTTAGES</span> <span class="token punctuation">}</span> #Can replace <span class="token constant">EVIL</span> <span class="token keyword">with</span> <span class="token constant">LAWFUL</span> <span class="token keyword">for</span> different enemies
<span class="token punctuation">}</span>

<span class="token string">"9.3.1 Yellow Dragon Campaign"</span> inherit <span class="token string">"9.1 Red Dragon Adventurer"</span>
<span class="token punctuation">{</span>
  creatureId <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"YELLOW_DRAGON"</span> <span class="token punctuation">}</span> #Found <span class="token keyword">in</span> Vanilla creatures<span class="token punctuation">.</span>txt 
  description <span class="token operator">=</span> <span class="token string">"Play the dragon campaign as a red dragon. The dragon campaign features mostly knights and other dragons as enemies."</span>  
  baseName <span class="token operator">=</span> <span class="token string">"Dragon Campaign"</span>
  villainGroups <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token constant">DRAGON_CAMPAIGN</span> <span class="token constant">DRAGON_COTTAGES</span> <span class="token punctuation">}</span> #Can replace <span class="token constant">EVIL</span> <span class="token keyword">with</span> <span class="token constant">LAWFUL</span> <span class="token keyword">for</span> different enemies
<span class="token punctuation">}</span>

<span class="token string">"9.4.1 White Dragon Campaign"</span> inherit <span class="token string">"9.1 Red Dragon Adventurer"</span>
<span class="token punctuation">{</span>
  creatureId <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"WHITE_DRAGON"</span> <span class="token punctuation">}</span> #Found <span class="token keyword">in</span> Vanilla creatures<span class="token punctuation">.</span>txt 
  description <span class="token operator">=</span> <span class="token string">"Play the dragon campaign as a white dragon. The dragon campaign features mostly knights and other dragons as enemies."</span>  
  baseName <span class="token operator">=</span> <span class="token string">"Dragon Campaign"</span>
  villainGroups <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token constant">DRAGON_CAMPAIGN</span> <span class="token constant">DRAGON_COTTAGES</span> <span class="token punctuation">}</span> #Can replace <span class="token constant">EVIL</span> <span class="token keyword">with</span> <span class="token constant">LAWFUL</span> <span class="token keyword">for</span> different enemies
<span class="token punctuation">}</span>

<span class="token string">"9.5.1 BLACK Dragon Campaign"</span> inherit <span class="token string">"9.1 Red Dragon Adventurer"</span>
<span class="token punctuation">{</span>
  creatureId <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"BLACK_DRAGON_PLAYER"</span> <span class="token punctuation">}</span> #Found <span class="token keyword">in</span> Vanilla creatures<span class="token punctuation">.</span>txt 
  description <span class="token operator">=</span> <span class="token string">"Play the dragon campaign as a black dragon. The dragon campaign features mostly knights and other dragons as enemies."</span>  
  baseName <span class="token operator">=</span> <span class="token string">"Dragon Campaign"</span>
  villainGroups <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token constant">DRAGON_CAMPAIGN</span> <span class="token constant">DRAGON_COTTAGES</span> <span class="token punctuation">}</span> #Can replace <span class="token constant">EVIL</span> <span class="token keyword">with</span> <span class="token constant">LAWFUL</span> <span class="token keyword">for</span> different enemies
<span class="token punctuation">}</span>

<span class="token string">"9.6.1 Blue Dragon Campaign"</span> inherit <span class="token string">"9.1 Red Dragon Adventurer"</span>
<span class="token punctuation">{</span>
  creatureId <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">"BLUE_DRAGON"</span> <span class="token punctuation">}</span> #From the modded version <span class="token keyword">of</span> creatures<span class="token punctuation">.</span>txt 
  description <span class="token operator">=</span> <span class="token string">"Play the dragon campaign as a blue dragon. The dragon campaign features mostly knights and other dragons as enemies."</span>  
  baseName <span class="token operator">=</span> <span class="token string">"Dragon Campaign"</span>
  villainGroups <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token constant">DRAGON_CAMPAIGN</span> <span class="token constant">DRAGON_COTTAGES</span> <span class="token punctuation">}</span> #Can replace <span class="token constant">EVIL</span> <span class="token keyword">with</span> <span class="token constant">LAWFUL</span> <span class="token keyword">for</span> different enemies
<span class="token punctuation">}</span>
</code></pre></div></div><div id="tab2" class="tabcontent" style="display: none;"><label>Enter content of creatures.txt:</label><span class="checkbox-container"><input type="checkbox" id="viewToggle2"><label for="viewToggle2"> View as code</label></span><textarea id="creatures_txt" rows="15"># The red dragon creature is already defined in:

# https://github.com/miki151/keeperrl/tree/master/data_free/game_config/creatures.txt

# There is no work to do here yet.</textarea><div class="code-container" style="display: none;"><pre class="language-javascript" tabindex="0"><code class="language-javascript"># The red dragon creature is already defined <span class="token keyword">in</span><span class="token operator">:</span>

# https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>github<span class="token punctuation">.</span>com<span class="token operator">/</span>miki151<span class="token operator">/</span>keeperrl<span class="token operator">/</span>tree<span class="token operator">/</span>master<span class="token operator">/</span>data_free<span class="token operator">/</span>game_config<span class="token operator">/</span>creatures<span class="token punctuation">.</span>txt

# There is no work to <span class="token keyword">do</span> here yet<span class="token punctuation">.</span></code></pre></div></div><div id="tab3" class="tabcontent" style="display: none;"><label>Enter content of campaign_villains.txt:</label><span class="checkbox-container"><input type="checkbox" id="viewToggle3"><label for="viewToggle3"> View as code</label></span><textarea id="campaign_villains_txt" rows="15">#  { EVIL_KEEPER EVIL_COTTAGES } are already defined here:

# https://github.com/miki151/keeperrl/tree/master/data_free/game_config/campaign_villains.txt

# EVIL_KEEPER and EVIL_COTTAGES are two separate list of enemies that will be encountered when playing the keeper.

# This is the normal list for evil keepers</textarea><div class="code-container" style="display: none;"><pre class="language-javascript" tabindex="0"><code class="language-javascript">#  <span class="token punctuation">{</span> <span class="token constant">EVIL_KEEPER</span> <span class="token constant">EVIL_COTTAGES</span> <span class="token punctuation">}</span> are already defined here<span class="token operator">:</span>

# https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>github<span class="token punctuation">.</span>com<span class="token operator">/</span>miki151<span class="token operator">/</span>keeperrl<span class="token operator">/</span>tree<span class="token operator">/</span>master<span class="token operator">/</span>data_free<span class="token operator">/</span>game_config<span class="token operator">/</span>campaign_villains<span class="token punctuation">.</span>txt

# <span class="token constant">EVIL_KEEPER</span> and <span class="token constant">EVIL_COTTAGES</span> are two separate list <span class="token keyword">of</span> enemies that will be encountered when playing the keeper<span class="token punctuation">.</span>

# This is the normal list <span class="token keyword">for</span> evil keepers</code></pre></div></div><div id="tab4" class="tabcontent" style="display: none;"><label>Enter content of enemies.txt:</label><span class="checkbox-container"><input type="checkbox" id="viewToggle4"><label for="viewToggle4"> View as code</label></span><textarea id="enemies_txt" rows="15"># No new enemies need to be defined for this tutorial.

# You would put them in here and add them to any custom campaign villains you wanted.</textarea><div class="code-container" style="display: none;"><pre class="language-javascript" tabindex="0"><code class="language-javascript"># No <span class="token keyword">new</span> <span class="token class-name">enemies</span> need to be defined <span class="token keyword">for</span> <span class="token keyword">this</span> tutorial<span class="token punctuation">.</span>

# You would put them <span class="token keyword">in</span> here and add them to any custom campaign villains you wanted<span class="token punctuation">.</span></code></pre></div></div></div>

    <!-- Download button at the bottom -->
    <button id="downloadZip">Download your mod as a .zip file</button>

<script>
    // Array of file names and default content
    const files = [
        { name: "details.txt", defaultContent: `"Softmonster"\n"Mod Template"` },
        { name: "keeper_creatures.txt", defaultContent: `"9.1 Test Keeper"\n{\n}` },
        { name: "creatures.txt", defaultContent: `` },
        { name: "campaign_villains.txt", defaultContent: `` },		
        { name: "enemies.txt", defaultContent: `` }	
    ];

    // References to DOM elements
    const tabContainer = document.getElementById("tabContainer");
    const tabContentContainer = document.getElementById("tabContentContainer");

    // Function to create a tab button
    function createTabButton(file, index) {
        const button = document.createElement("button");
        button.className = "tablinks";
        button.textContent = file.name;
        button.onclick = (event) => openTab(event, `tab${index}`);
        if (index === 0) button.id = "defaultOpen";  // Set default open tab
        tabContainer.appendChild(button);
    }

    // Function to add click handler to an existing tab button
    function addClickHandlerToExistingTabButton(file, index) {
        const button = Array.from(tabContainer.querySelectorAll("button")).find(btn => btn.textContent === file.name);
        if (button) {
            button.onclick = (event) => openTab(event, `tab${index}`);
        }
    }

    // Function to create tab content
    function createTabContent(file, index) {
        const tabContent = document.createElement("div");
        tabContent.id = `tab${index}`;
        tabContent.className = "tabcontent";

        const label = document.createElement("label");
        label.textContent = `Enter content of ${file.name}:`;

        const checkbox = document.createElement("input");
        checkbox.type = "checkbox";
        checkbox.id = `viewToggle${index}`;
        checkbox.addEventListener('change', () => toggleView(index));

        const checkboxLabel = document.createElement("label");
        checkboxLabel.htmlFor = `viewToggle${index}`;
        checkboxLabel.textContent = " View as code";
        
        const checkboxContainer = document.createElement("span");
        checkboxContainer.className = "checkbox-container";
        checkboxContainer.appendChild(checkbox);
        checkboxContainer.appendChild(checkboxLabel);

        const textarea = document.createElement("textarea");
        textarea.id = file.name.replace('.', '_');
        textarea.value = file.defaultContent;

        const codeContainer = document.createElement("div");
        codeContainer.className = "code-container";
        const codeBlock = document.createElement("pre");
        codeBlock.innerHTML = `<code class="language-javascript">${textarea.value}</code>`;
        codeContainer.appendChild(codeBlock);

        tabContent.appendChild(label);
        tabContent.appendChild(checkboxContainer);
        tabContent.appendChild(textarea);
        tabContent.appendChild(codeContainer);
        tabContentContainer.appendChild(tabContent);
    }

    // Function to add checkbox handler to existing tab content
    function addCheckboxHandlerToExistingTabContent(file, index) {
        const checkbox = document.getElementById(`viewToggle${index}`);
        if (checkbox) {
            checkbox.addEventListener('change', () => toggleView(index));
        }
    }

    // Create tabs and content areas dynamically only if they don't already exist
    files.forEach((file, index) => {
        // Check if a button with the same file name (or content) already exists
        const tabExists = Array.from(tabContainer.querySelectorAll("button")).some(btn => btn.textContent === file.name);
        const contentExists = document.getElementById(`tab${index}`);

        // Create tab button only if it doesn't exist
        if (!tabExists) {
            createTabButton(file, index);
        } else {
            addClickHandlerToExistingTabButton(file, index);
        }

        // Create tab content only if it doesn't exist
        if (!contentExists) {
            createTabContent(file, index);
        } else {
            addCheckboxHandlerToExistingTabContent(file, index);
        }
    });

    // Tab switch functionality
    function openTab(evt, tabName) {
        // Hide all tab contents
        const tabcontent = document.getElementsByClassName("tabcontent");
        Array.from(tabcontent).forEach(content => content.style.display = "none");

        // Deactivate all tab buttons
        const tablinks = document.getElementsByClassName("tablinks");
        Array.from(tablinks).forEach(link => link.className = link.className.replace(" active", ""));

        // Show the selected tab content and activate the tab button
        document.getElementById(tabName).style.display = "block";
        evt.currentTarget.className += " active";
    }

    // Toggle view between textarea and code
    function toggleView(index) {
        const textarea = document.getElementById(files[index].name.replace('.', '_'));
        const codeContainer = document.querySelector(`#tab${index} .code-container`);
        const checkbox = document.getElementById(`viewToggle${index}`);

        if (checkbox.checked) {
            textarea.style.display = "none";
            codeContainer.style.display = "block";
        } else {
            textarea.style.display = "block";
            codeContainer.style.display = "none";
        }

        // Update code block with current textarea value
        const codeBlock = codeContainer.querySelector('code');
        codeBlock.innerHTML = textarea.value;
        Prism.highlightElement(codeBlock); // Highlight syntax
    }

    // Open the first tab by default
    document.getElementById("defaultOpen").click();

    // Download functionality
    document.getElementById('downloadZip').addEventListener('click', function () {
	    const zip = new JSZip();
        const modName = document.getElementById('modName').value || 'TestKeeper';
		const sanitizedModName = modName.replace(/[<>:"/\\|?*]/g, '_');
		const modFolder = zip.folder(sanitizedModName);		

        // Add file content from each tab to the ZIP file
        files.forEach(file => {
            const content = document.getElementById(file.name.replace('.', '_')).value;
            if (content.trim()) {
                modFolder.file(file.name, content);
            }
        });

        // Add current HTML (with updated content) to the ZIP file
        const htmlSource = updateHtmlSourceWithContent();
        modFolder.file("NowYouTry.html", htmlSource);
		
       // Put in the version info file to make the mod appear in the mods list in-game.
        modFolder.file("version_info", "0\n0\nAlpha37");

        // Create the install batch file for the mod.
        addInstallBatchFile(modFolder);

        // Generate the ZIP and trigger download
        zip.generateAsync({ type: "blob" }).then(function (content) {
            saveAs(content, `${modName}.zip`);
        });
    });
		
    // Function to add Install.bat file to the ZIP archive
    function addInstallBatchFile(modFolder) {
        const installBatContent = `
		
@echo off
setlocal

:: Get the full path of the current batch file
set "currentFilePath=%~dp0"

:: Get the name of the folder containing the batch file
for %%F in ("%currentFilePath%.") do set "currentDirName=%%~nxF"

:: Display the folder name
echo The folder name containing the batch file is: %currentDirName%

:: Initialize variables
set "steamDir="
set "steamAppsDir="

:: Define common Steam installation paths as an array-like structure
set "commonPaths=C:\\Program Files (x86)\\Steam"
set "commonPaths2=C:\\Program Files\\Steam"
set "commonPaths3=D:\\Steam"

:: Check common paths
for %%P in ("%commonPaths%" "%commonPaths2%" "%commonPaths3%") do (
    if exist "%%~P\\steam.exe" (
        set "steamDir=%%~P"
        set "steamAppsDir=%%~P\\steamapps"
        goto :found
    )
)

:: If Steam is not found, print an error message and pause
echo Error: Steam installation not found in common paths.
pause
exit /b

:found
echo Steam directory: %steamDir%
echo SteamApps directory: %steamAppsDir%

:: Set the target directory where the new folder will be created
set "targetDir=%steamAppsDir%\\common\\KeeperRL\\mods\\%currentDirName%"

:: Create the new folder
mkdir "%targetDir%" || (
    echo Error: Failed to create target directory %targetDir%.
    pause
    exit /b
)

:: Copy the contents of the current directory to the new folder
xcopy "%currentFilePath%*" "%targetDir%\\" /E /I /Y || (
    echo Error: Failed to copy files to %targetDir%.
    pause
    exit /b
)

echo Files copied to %targetDir%.
pause
`;

        modFolder.file("Install.bat", installBatContent);
    }


    // Update the HTML source with the current content of each file's tab
    function updateHtmlSourceWithContent() {
        let htmlSource = document.documentElement.outerHTML;

        // Update each textarea in the HTML source with the current tab content
        files.forEach(file => {
            const content = document.getElementById(file.name.replace('.', '_')).value;
            const regex = new RegExp(`<textarea id="${file.name.replace('.', '_')}"[\\s\\S]*?<\\/textarea>`, 'g');
            htmlSource = htmlSource.replace(regex, `<textarea id="${file.name.replace('.', '_')}" rows="${file.name === "details.txt" ? 6 : 15}">${content}</textarea>`);
        });

        return htmlSource;
    }
</script>



</body></html>